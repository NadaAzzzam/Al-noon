<div class="container order-detail-page">
  @if (loading()) {
    <p class="loading">{{ 'orders.loading' | translate }}</p>
  } @else if (!order()) {
    <p class="not-found">{{ 'orderDetail.notFound' | translate }}</p>
  } @else {
    @let o = order()!;
    <h1 class="page-title">{{ 'orderDetail.order' | translate }} #{{ o.id.slice(0, 8) }}</h1>
    <p class="order-status">{{ 'orderDetail.status' | translate }}: {{ o.status }}</p>
    @if (o.shippingAddress) {
      <p class="shipping-address">{{ 'orderDetail.shipping' | translate }}: {{ o.shippingAddress }}</p>
    }
    <div class="order-items">
      <h2>{{ 'orderDetail.items' | translate }}</h2>
      @for (item of o.items; track $index) {
        <div class="order-item">
          <img [src]="api.imageUrl(item.product.images[0])" [alt]="getLocalized(item.product.name)" class="item-image" />
          <div class="item-details">
            <a [routerLink]="['/product', item.product.id]">{{ getLocalized(item.product.name) }}</a>
            <p>× {{ item.quantity }} — LE {{ item.price }} EGP</p>
          </div>
          <span class="item-total">LE {{ item.quantity * item.price }} EGP</span>
        </div>
      }
    </div>
    <div class="order-totals">
      @if (o.deliveryFee != null && o.deliveryFee > 0) {
        <p><span>{{ 'checkout.delivery' | translate }}</span><span>LE {{ o.deliveryFee }} EGP</span></p>
      }
      <p class="total"><span>{{ 'orderDetail.total' | translate }}</span><span>LE {{ o.total }} EGP</span></p>
    </div>
    <a [routerLink]="['/account', 'orders']" class="btn btn-outline">{{ 'orderDetail.backToOrders' | translate }}</a>
  }
</div>
