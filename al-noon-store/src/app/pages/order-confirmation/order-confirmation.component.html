@if (!order()) {
<div class="confirmation-empty">
  <p>{{ 'orderConfirmation.notFound' | translate }}</p>
  <a [routerLink]="['/catalog']" class="btn">{{ 'orderConfirmation.continueShopping' | translate }}</a>
</div>
} @else {
@let o = order()!;
<div class="confirmation-wrapper">
  <!-- ═══ Left Column ═══ -->
  <div class="confirmation-left">
    <div class="confirmation-inner">

      <!-- Header: check icon + confirmation number + thank you -->
      <div class="confirmation-header">
        <div class="confirmation-check">
          <svg width="40" height="40" viewBox="0 0 24 24" fill="none">
            <circle cx="12" cy="12" r="11" stroke="#1773b0" stroke-width="1.5" />
            <path d="M7 13l3 3 7-7" stroke="#1773b0" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
          </svg>
        </div>
        <div class="confirmation-header-text">
          <p class="confirmation-number">Confirmation #{{ o.id.slice(0, 10).toUpperCase() }}</p>
          <h1 class="confirmation-thanks">Thank you, {{ customerName() }}!</h1>
        </div>
      </div>

      <!-- Order confirmed box -->
      <div class="confirmed-box">
        <h2 class="confirmed-box-title">Your order is confirmed</h2>
        <p class="confirmed-box-text">You'll receive a confirmation email soon</p>
      </div>

      <!-- Order details -->
      <div class="order-details-card">
        <div class="order-details-header">
          <h2 class="order-details-title">Order details</h2>
          @if (isLoggedIn()) {
          <a [routerLink]="['/account', 'orders']" class="view-account-link">View account</a>
          }
        </div>

        <div class="order-details-grid">
          <!-- Left column -->
          <div class="details-column">
            <div class="detail-section">
              <h3 class="detail-label">Contact information</h3>
              <p class="detail-value">{{ contactEmail() }}</p>
            </div>

            <div class="detail-section">
              <h3 class="detail-label">Shipping address</h3>
              <p class="detail-value">{{ fullName() }}</p>
              @for (line of shippingLines(); track $index) {
              <p class="detail-value">{{ line }}</p>
              }
              <p class="detail-value">Egypt</p>
              @if (contactPhone()) {
              <p class="detail-value">{{ contactPhone() }}</p>
              }
            </div>

            <div class="detail-section">
              <h3 class="detail-label">Shipping method</h3>
              <p class="detail-value">{{ shippingMethodDisplay() }}</p>
            </div>
          </div>

          <!-- Right column -->
          <div class="details-column">
            <div class="detail-section">
              <h3 class="detail-label">Payment method</h3>
              <div class="payment-method-display">
                <span class="payment-icon">
                  <svg width="20" height="16" viewBox="0 0 24 20" fill="none">
                    <rect x="1" y="1" width="22" height="18" rx="3" stroke="#666" stroke-width="1.5" />
                    <circle cx="9" cy="10" r="4" fill="#ddd" />
                    <circle cx="15" cy="10" r="4" fill="#bbb" />
                  </svg>
                </span>
              </div>
              <p class="detail-value">{{ paymentDisplay() }} - LE {{ o.total | number:'1.2-2' }} EGP</p>
            </div>

            <div class="detail-section">
              <h3 class="detail-label">Billing address</h3>
              <p class="detail-value">{{ fullName() }}</p>
              @for (line of billingLines(); track $index) {
              <p class="detail-value">{{ line }}</p>
              }
              <p class="detail-value">Egypt</p>
              @if (contactPhone()) {
              <p class="detail-value">{{ contactPhone() }}</p>
              }
            </div>
          </div>
        </div>
      </div>

      <!-- Footer actions -->
      <div class="confirmation-footer">
        <p class="help-text">
          Need help?
          <a [routerLink]="['/contact']" class="help-link">Contact us</a>
        </p>
        <a [routerLink]="['/catalog']" class="continue-btn">Continue shopping</a>
      </div>

    </div>
  </div>

  <!-- ═══ Right Column: Order Summary ═══ -->
  <div class="confirmation-right">
    <div class="order-summary">
      <!-- Product items -->
      <div class="summary-products">
        @for (item of o.items; track $index) {
        <div class="summary-product">
          <div class="summary-product-image">
            @if (item.product.images.length) {
            <img [src]="api.imageUrl(item.product.images[0])" [alt]="getLocalized(item.product.name)" loading="lazy" />
            }
            <span class="summary-product-qty">{{ item.quantity }}</span>
          </div>
          <div class="summary-product-info">
            <span class="summary-product-name">{{ getLocalized(item.product.name) || 'Product' }}</span>
            @if (item.product.sizes && item.product.sizes.length) {
            <span class="summary-product-variant">{{ item.product.sizes[0] }}</span>
            }
          </div>
          <span class="summary-product-price">LE {{ (item.price * item.quantity) | number:'1.2-2' }} EGP</span>
        </div>
        }
      </div>

      <!-- Subtotal, Shipping, Total -->
      <div class="summary-totals">
        <div class="summary-row">
          <span>Subtotal</span>
          <span>LE {{ subtotal() | number:'1.2-2' }} EGP</span>
        </div>
        <div class="summary-row">
          <span>Shipping</span>
          <span>LE {{ deliveryFee() | number:'1.2-2' }} EGP</span>
        </div>
        <div class="summary-row summary-total">
          <span>Total</span>
          <span class="summary-total-price">
            <small>EGP</small> LE {{ o.total | number:'1.2-2' }}
          </span>
        </div>
      </div>
    </div>
  </div>
</div>
}